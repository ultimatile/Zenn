---
title: "rsyncã§ãƒã‚§ãƒƒã‚¯ã‚µãƒ ã«ã‚ˆã‚‹è»¢é€ãƒ•ã‚¡ã‚¤ãƒ«å·®åˆ†è¨ˆç®—æ™‚ã«ç‰¹å®šã‚µã‚¤ã‚ºã®ãƒ•ã‚¡ã‚¤ãƒ«ã§å­˜åœ¨ã—ãªã„å·®åˆ†ã‚’èª¤æ¤œçŸ¥ã™ã‚‹å•é¡Œ"
emoji: "ğŸ›"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [cli, mac, linux, rsync]
published: true
---

## æ¦‚è¦

rsyncã¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’åŠ¹ç‡çš„ã«åŒæœŸãƒ»è»¢é€ã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚

rsyncã¯è»¢é€å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã«å·®åˆ†ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã§å·®åˆ†ã‚’åˆ¤å®šã—ã¾ã™ãŒã€`--checksum`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã¨ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã®ãƒã‚§ãƒƒã‚¯ã‚µãƒ ï¼ˆãƒãƒƒã‚·ãƒ¥å€¤ï¼‰ã§åˆ¤å®šã—ã¾ã™ã€‚

ã“ã®ãƒã‚§ãƒƒã‚¯ã‚µãƒ è¨ˆç®—ã«ãƒã‚°ãŒã‚ã‚Šã€ç‰¹å®šæ¡ä»¶ä¸‹ã§åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ãªã®ã«å·®åˆ†ã‚ã‚Šã¨èª¤èªè­˜ã•ã‚Œã‚‹å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚

ã“ã®ãƒã‚°ã¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«29ã‹ã¤ãƒã‚§ãƒƒã‚¯ã‚µãƒ ã«ã‚ˆã‚‹å·®åˆ†è¨ˆç®—ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã«ç™ºç”Ÿã—ã¾ã™ã€‚
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã§å·®åˆ†è¨ˆç®—ã™ã‚‹ãŸã‚ã€å¤šãã®å ´åˆã¯å½±éŸ¿ã‚’å—ã‘ã¾ã›ã‚“ã€‚

macOS 15.7 (Sequoia) ã«ãƒ—ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹rsync ([openrsync](https://github.com/kristapsdz/openrsync))ã¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«29ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

```shell-session
$ rsync -V
openrsync: protocol version 29
rsync version 2.6.9 compatible
```

## ç™ºç”Ÿæ¡ä»¶

- ãƒ­ãƒ¼ã‚«ãƒ«â†’ãƒªãƒ¢ãƒ¼ãƒˆé–“ã®è»¢é€ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«é–“ã§ã¯ç™ºç”Ÿã—ãªã„ï¼‰
- ãƒ—ãƒ­ãƒˆã‚³ãƒ«29ã‚’ä½¿ç”¨
- `--checksum`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å·®åˆ†è¨ˆç®—
- ã‚µã‚¤ã‚ºãŒ64ã®å€æ•°ãƒã‚¤ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«
- ãƒªãƒ¢ãƒ¼ãƒˆå´ãŒrsync 3.2.5ï¼ˆ3.1.3ã§ã¯ç™ºç”Ÿã—ãªã„ï¼‰

æ­£ç¢ºãªæ¡ä»¶ãŒä¸æ˜ãªãŸã‚ã€ä»–ã®æ¡ä»¶ã‚‚å½±éŸ¿ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

## å†ç¾æ‰‹é †

`your-remote-host`ã‚’é©åˆ‡ãªãƒªãƒ¢ãƒ¼ãƒˆãƒ›ã‚¹ãƒˆåã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

```bash
# 64ãƒã‚¤ãƒˆã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
head -c 64 /dev/urandom | base64 | head -c 64 > /tmp/test64.bin

# ãƒªãƒ¢ãƒ¼ãƒˆã«åŒæœŸ
rsync -avz /tmp/test64.bin your-remote-host:~/test64.bin

# ãƒã‚§ãƒƒã‚¯ã‚µãƒ ã§å·®åˆ†ç¢ºèªï¼ˆãƒã‚°ãŒç™ºç”Ÿã™ã‚‹ï¼‰
rsync -avz --checksum --protocol=29 --dry-run --itemize-changes  /tmp/test64.bin your-remote-host:~/test64.bin
```

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³èª¬æ˜

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | èª¬æ˜ |
|-----------|------|
| `--checksum` | å·®åˆ†è¨ˆç®—ã«ãƒã‚§ãƒƒã‚¯ã‚µãƒ ã‚’ä½¿ç”¨ |
| `--protocol=29` | ãƒ—ãƒ­ãƒˆã‚³ãƒ«29ã‚’å¼·åˆ¶ |
| `--dry-run` | å®Ÿéš›ã«ã¯è»¢é€ã—ãªã„ |
| `--itemize-changes` | å¤‰æ›´å†…å®¹ã‚’è©³ç´°è¡¨ç¤º |

ãªãŠã€`--protocol=29`ã¯GPLç‰ˆrsyncã§openrsyncã¨ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’åˆã‚ã›ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
openrsyncã§ã¯æŒ‡å®šã—ãªã‘ã‚Œã°ãƒ—ãƒ­ãƒˆã‚³ãƒ«29ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

### å‡ºåŠ›ä¾‹

```shell-session
building file list ... done
<fc......... test64.bin

sent 92 bytes  received 30 bytes  81.33 bytes/sec
total size is 64  speedup is 0.52 (DRY RUN)
```

`<fc`ã¯ãƒã‚§ãƒƒã‚¯ã‚µãƒ ä¸ä¸€è‡´ã‚’æ„å‘³ã—ã¦ãŠã‚Šã€åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¯”è¼ƒã—ã¦ã„ã‚‹ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€é•ã†ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦èªè­˜ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚
å·®åˆ†ãŒãªã‘ã‚Œã°ã“ã®è¡Œã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

## å›é¿æ³•

- ãƒ—ãƒ­ãƒˆã‚³ãƒ«30ä»¥é™ã‚’ä½¿ç”¨ã™ã‚‹
- GPLç‰ˆrsyncã§`--checksum-choice=md4`ã¾ãŸã¯`md5`ã‚’æŒ‡å®š
  - openrsyncã§ã¯`--checksum-choice`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒãªã„ãŸã‚ä½¿ç”¨ä¸å¯
- ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã«ã‚ˆã‚‹å·®åˆ†è¨ˆç®—ã‚’ä½¿ç”¨ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
- ãƒªãƒ¢ãƒ¼ãƒˆã§GPLç‰ˆrsync 3.2ä»¥å¤–ã‚’ä½¿ç”¨ã™ã‚‹ï¼ˆè¦æ¤œè¨¼ï¼‰

## æ¤œè¨¼ç’°å¢ƒ

openrsyncå›ºæœ‰ã®å•é¡Œã§ã¯ãªã„ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã€Homebrewã§[GPLç‰ˆrsync](https://rsync.samba.org)ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦æ¤œè¨¼ã—ã¾ã—ãŸã€‚
Homebrewç‰ˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨`rsync`ã‚³ãƒãƒ³ãƒ‰ãŒHomebrewç‰ˆã«ç½®ãæ›ã‚ã‚‹ãŸã‚ã€macOSãƒ—ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç‰ˆã¯`/usr/bin/rsync`ã€Homebrewç‰ˆã¯`/opt/homebrew/bin/rsync`ã¨ãƒ•ãƒ«ãƒ‘ã‚¹ã§æŒ‡å®šã—ã¦ä½¿ã„åˆ†ã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

| ç’°å¢ƒ | OS | rsyncãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
|-----|-----|-----------|
| ãƒ­ãƒ¼ã‚«ãƒ« (macOSãƒ—ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«) | macOS 15.7.2 | openrsync protocol version 29 |
| ãƒ­ãƒ¼ã‚«ãƒ« (Homebrew) | åŒä¸Š | GPLç‰ˆrsync 3.4.1 protocol version 32 |
| ãƒªãƒ¢ãƒ¼ãƒˆ (ç™ºç”Ÿ) | Rocky Linux 9.7 | GPLç‰ˆrsync 3.2.5 protocol version 31 |
| ãƒªãƒ¢ãƒ¼ãƒˆ (ç™ºç”Ÿã›ãš) | RHEL 8.10 | GPLç‰ˆrsync 3.1.3 protocol version 31 |
